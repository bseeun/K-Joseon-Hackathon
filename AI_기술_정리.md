# MARINOVA 프로젝트 AI 기술 정리

## 📋 개요
조선·해양 매뉴얼 기반 RAG(Retrieval-Augmented Generation) 챗봇 시스템으로, PDF 매뉴얼을 업로드하여 질문-답변 및 퀴즈 생성 기능을 제공합니다.

---

## 🤖 사용된 AI 기술

### 1. **RAG (Retrieval-Augmented Generation)**
- **목적**: 매뉴얼 문서에서 관련 정보를 검색하여 정확한 답변 생성
- **구현 방식**:
  - 사용자 질문 → 벡터 검색으로 관련 문서 청크 추출 → GPT에게 컨텍스트와 함께 질문 전달
  - 매 질문마다 최신 문서 정보를 검색하여 답변 생성
- **장점**: 
  - LLM의 환각(Hallucination) 문제 완화
  - 최신 문서 정보 반영 가능
  - 출처 추적 가능

### 2. **임베딩 (Embedding)**
- **모델**: OpenAI `text-embedding-3-small`
- **용도**: 
  - 문서 청크를 벡터로 변환
  - 사용자 질문을 벡터로 변환하여 유사도 검색
- **특징**:
  - 1536차원 벡터
  - 코사인 유사도 기반 검색
  - 배치 처리 지원 (128개씩)

### 3. **벡터 검색 (Vector Search)**
- **라이브러리**: FAISS (Facebook AI Similarity Search)
- **인덱스 타입**: `IndexFlatIP` (Inner Product, 코사인 유사도와 동일)
- **동작**:
  - 모든 매뉴얼의 청크를 벡터로 변환하여 인덱스 구축
  - 질문 벡터와 가장 유사한 상위 K개 청크 검색
  - 검색 결과를 GPT에게 컨텍스트로 제공

### 4. **LLM (Large Language Model)**
- **모델**: OpenAI GPT-4o-mini
- **사용 용도**:
  1. **챗봇 답변 생성**: RAG 검색 결과를 바탕으로 답변 생성
  2. **퀴즈 생성**: 객관식 및 순서 맞추기 문제 생성
- **특징**:
  - 대화 히스토리 유지 (최근 10개 메시지)
  - Temperature: 0.2 (일관된 답변)
  - Max Tokens: 2000 (답변 길이 제한)

### 5. **PDF 파싱 및 청킹**
- **라이브러리**: PyMuPDF (fitz)
- **기능**:
  - PDF에서 텍스트, 테이블, 이미지 추출
  - 헤더/본문 구분 (폰트 크기 기반)
  - 의미 단위로 청크 분할 (섹션 단위)
  - 페이지 번호 및 메타데이터 보존

### 6. **이미지 처리**
- **라이브러리**: Pillow (PIL)
- **기능**: PDF에서 이미지 추출 및 표시

---

## 🔧 기술 스택

### 핵심 AI/ML 라이브러리
- **OpenAI API**: GPT-4o-mini, text-embedding-3-small
- **FAISS**: 벡터 검색 인덱스
- **NumPy**: 벡터 연산

### 문서 처리
- **PyMuPDF**: PDF 파싱
- **Pandas**: 테이블 데이터 처리
- **python-docx**: DOCX 파일 처리 (역할 정보)

### 웹 프레임워크
- **Streamlit**: 웹 UI 프레임워크
- **streamlit-sortables**: 드래그 앤 드롭 UI 컴포넌트

### 기타
- **python-dotenv**: 환경변수 관리
- **orjson**: JSON 처리

---

## 🎯 주요 기능별 AI 기술 활용

### 1. **챗봇 기능**
```
사용자 질문 
  → 임베딩 변환 
  → FAISS 벡터 검색 (상위 5개 청크)
  → GPT-4o-mini에게 컨텍스트 + 질문 전달
  → 답변 생성 (대화 히스토리 포함)
```

### 2. **퀴즈 생성 기능**
- **객관식 퀴즈**:
  - GPT-4o-mini가 매뉴얼 내용 기반으로 문제 생성
  - 4지선다 형식
  - 정답 설명 포함
  
- **순서 맞추기 퀴즈**:
  - 절차/프로세스 기반 문제 생성
  - 섞인 항목을 올바른 순서로 배열

### 3. **문서 인덱싱**
```
PDF 업로드
  → PyMuPDF로 파싱 (텍스트, 테이블, 이미지)
  → 의미 단위 청킹
  → OpenAI Embedding API로 벡터화
  → FAISS 인덱스 구축 및 저장
```

---

## 📊 데이터 흐름

1. **문서 업로드 단계**:
   - PDF → 파싱 → 청킹 → 임베딩 → 인덱스 저장

2. **질문 처리 단계**:
   - 질문 → 임베딩 → 벡터 검색 → 관련 청크 추출 → GPT 답변 생성

3. **퀴즈 생성 단계**:
   - 청크 선택 (무작위 또는 주제 기반) → GPT 문제 생성 → JSON 파싱

---

## 💡 기술적 특징

### 장점
- ✅ **정확성**: RAG로 문서 기반 정확한 답변
- ✅ **확장성**: 여러 매뉴얼 동시 검색 가능
- ✅ **대화 연속성**: 히스토리 유지로 자연스러운 대화
- ✅ **출처 추적**: 답변의 출처(페이지, 제목) 제공
- ✅ **다국어 지원**: 한국어, 영어, 중국어, 일본어

### 제한사항
- ⚠️ **토큰 제한**: 최근 10개 메시지만 히스토리 유지
- ⚠️ **검색 한계**: 임베딩 모델의 이해도에 의존
- ⚠️ **비용**: OpenAI API 사용량에 따른 비용 발생

---

## 🔄 향후 개선 가능 사항

1. **하이브리드 검색**: 키워드 검색 + 벡터 검색 결합
2. **리랭킹**: 검색 결과 재정렬 (Cross-Encoder)
3. **청킹 최적화**: 의미 단위 청킹 개선
4. **캐싱**: 자주 묻는 질문 캐싱
5. **멀티모달**: 이미지 기반 질문-답변

---

## 📝 참고사항

- **임베딩 모델**: text-embedding-3-small (1536차원)
- **LLM 모델**: gpt-4o-mini (비용 효율적)
- **검색 방식**: 코사인 유사도 (Inner Product)
- **인덱스 타입**: FAISS IndexFlatIP (정확한 검색, 빠른 속도)

